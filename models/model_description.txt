# 모델 설명 (Model Descriptions)

이 파일은 프로젝트에서 실험하고 저장한 각 모델 파일(.pth)에 대한 설명을 기록합니다.

---

### 1. model_multi_task_mre_24.5px.pth

- 종류: 멀티태스크 (랜드마크 예측 + CVM 분류)
- 백본: ResNet-18
- 입력: 256x256 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 24.5 픽셀
- 설명:
  - `feature/mre-optimization` 브랜치에서 훈련된 중간 결과물입니다.
  - 이 모델은 `evaluate.py`와 `visualize.py` 간의 데이터 변환 불일치로 인해 시각화 결과가 실제 성능과 다르게 나타나는 버그가 있었던 시점의 모델입니다.
  - 이 버그를 수정한 후, MRE 18.4px 모델로 성능이 개선되었습니다.
- 참고: `memo.txt`의 21 항목

---

### 2. model_resnet18_256x256_mre18.4.pth

- 종류: 멀티태스크 (랜드마크 예측 + CVM 분류)
- 백본: ResNet-18
- 입력: 256x256 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 18.4 픽셀
  - CVM 분류 F1-점수: 약 0.22
- 설명:
  - `feature/mre-optimization` 브랜치에서 훈련된 최종 모델입니다.
  - 랜드마크 좌표 스케일링 및 시각화 버그 수정 후, ResNet-18 백본으로 얻은 최상의 랜드마크 예측 성능을 기록했습니다.
  - CVM 분류 성능은 여전히 낮아, 이 모델 이후 더 큰 모델(ResNet-50) 및 ROI 기반 접근법으로 전환하게 되었습니다.
- 참고: `memo.txt`의 16, 23-1 항목

---

### 3. model_cvm_only_f1_0.1.pth

- 종류: CVM 분류 단독
- 백본: ResNet-18
- 입력: 224x224 크기의 경추 영역만 잘라낸 ROI 이미지
- 주요 성능:
  - CVM 분류 F1-점수: 약 0.1
- 설명:
  - CVM 성능 개선을 위해 ROI(관심 영역) 파이프라인을 처음으로 도입하여 실험한 모델입니다.
  - 클래스 불균형 문제를 처리하지 않은 상태에서 훈련하여, 모델이 의미 있는 학습에 실패했습니다. F1 점수가 0.1 근처에서 정체되었습니다.
  - 이 실험의 실패는 '가중 손실(Weighted Loss)' 기법 도입의 계기가 되었습니다.
- 참고: `memo.txt`의 28 항목

---

### 4. model_heatmap_resnet50_finetuned_mre4.5.pth

- 종류: 랜드마크 탐지 (히트맵 방식)
- 백본: ResNet-50
- 입력: 256x256 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 4.5 픽셀
- 설명:
  - 좌표 직접 회귀 방식의 한계를 극복하고 처음으로 성공한 히트맵 기반 모델입니다.
  - 1단계(헤드 훈련, MRE 38.4px)와 2단계(전체 모델 미세 조정) 훈련을 통해 성능을 달성했습니다.
  - 이 모델은 더 높은 해상도(512x512)의 입력을 사용하기 전, 256x256 해상도에서의 새로운 베이스라인 모델이 됩니다.
- 참고: `memo.txt`의 37 항목

---

### 5. model_heatmap_resnet50_512px_mre5.4.pth

- 종류: 랜드마크 탐지 (히트맵 방식)
- 백본: ResNet-50
- 입력: 512x512 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 5.4 픽셀
- 설명:
  - MRE 4.5px 모델을 기반으로, 입력 해상도를 512x512로 높여 처음 시도한 훈련의 결과물입니다.
  - 예상과 달리 256x256 모델보다 성능이 저하되었으며, 이는 고해상도 히트맵에 대한 하이퍼파라미터(특히 `sigma` 값)가 최적화되지 않았기 때문으로 분석됩니다.
- 참고: `memo.txt`의 39 항목

---

### 6. model_heatmap_resnet50_512px_sigma4_mre5.8.pth

- 종류: 랜드마크 탐지 (히트맵 방식)
- 백본: ResNet-50
- 입력: 512x512 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 5.8 픽셀
- 설명:
  - 512px 해상도에서 히트맵 타겟의 `sigma` 값을 4로 늘려 훈련한 실험 모델입니다.
  - `sigma=2`일 때(MRE 5.4px)보다 성능이 저하되어, 512px 해상도에서는 더 뾰족한(sharp) 타겟이 유리함을 확인했습니다.
- 참고: `memo.txt`의 40 항목

---

### 7. model_heatmap_resnet50_512px_weakaug_mre5.5.pth

- 종류: 랜드마크 탐지 (히트맵 방식)
- 백본: ResNet-50
- 입력: 512x512 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 5.5 픽셀
- 설명:
  - 512px 해상도에서 데이터 증강 강도를 낮추어 훈련한 실험 모델입니다.
  - 강한 증강을 사용했을 때(MRE 5.4px)와 거의 동일한 결과가 나옴에 따라, 증강 강도가 512px 모델의 성능을 제한하는 핵심 요인이 아님을 확인했습니다.
- 참고: `memo.txt`의 41 항목

---

### 8. model_unet_resnet50_512px_mre5.0.pth

- 종류: 랜드마크 탐지 (U-Net 히트맵 방식)
- 백본: ResNet-50
- 입력: 512x512 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 5.0 픽셀
- 설명:
  - 스킵 커넥션이 적용된 U-Net 아키텍처의 첫 훈련 결과물입니다.
  - 처음부터 훈련했음에도, 512px 해상도에서 이전의 단순 히트맵 모델들보다 우수한 성능(MRE ~5.0px)을 보여 U-Net 구조의 효과를 입증했습니다.
  - 하지만 아직 256px 모델의 최고 기록(4.5px)은 넘지 못했으며, 이는 다음 단계인 '전이 학습'의 필요성을 시사합니다.
- 참고: `memo.txt`의 42 항목

---

### 9. model_unet_transfer_512px_mre5.0.pth

- 종류: 랜드마크 탐지 (U-Net 히트맵 방식)
- 백본: ResNet-50
- 입력: 512x512 크기의 전체 두부 계측 방사선 사진
- 주요 성능:
  - 랜드마크 MRE(평균 반경 오차): 약 5.0 픽셀
- 설명:
  - U-Net 아키텍처에 256px 모델의 최적 가중치(MRE 4.5px)를 전이 학습시킨 실험 모델입니다.
  - 최종 성능이 처음부터 훈련한 U-Net 모델과 동일하게 나옴에 따라, U-Net 아키텍처가 충분히 강력하여 사전 훈련 가중치가 최종 성능에 추가적인 이점을 주지 못했음을 확인했습니다.
- 참고: `memo.txt`의 43 항목

---

### 10. model_unet_cvm_roi_f1-0.02.pth

- 종류: CVM 분류 (U-Net 방식)
- 백본: ResNet-50
- 입력: 224x224 크기의 경추 영역만 잘라낸 ROI 이미지
- 주요 성능:
  - CVM 분류 F1-점수: 약 0.02
- 설명:
  - CVM 분류를 위한 마지막 시도로, U-Net 아키텍처를 ROI 이미지에 직접 적용한 실험 모델입니다.
  - 훈련 결과 F1 점수가 0.02점에 머무르며, U-Net의 뛰어난 구조로도 CVM 단계를 학습할 수 없음을 최종적으로 확인함으로써, "Aariz 데이터셋의 주석만으로는 CVM 분류가 불가능하다"는 결론을 뒷받침합니다.
- 참고: `memo.txt`의 47 항목

---