안 1) 무라벨/약라벨: MIL + Ordinal 분류 (ROI 라벨 불요)

핵심: C2–C4 주변을 포함하도록 여러 패치를 자동 샘플링하고(전수/격자/확률적), 패치 임베딩을 어텐션-MIL로 집약하여 6단계 서열형(ordinal) 출력.

입력: 전체 측모 X-ray(라벨=단계만). 경추 박스/마스크 라벨 불요.

구현 포인트

dataset.py에 패치 생성 모드 추가(중심선 하부 영역 위주로 N개 패치 추출, 다중 스케일/회전 약간 허용).

백본(ConvNeXt-T/ResNet-18) + Attention pooling → 로짓 5개(CORAL; 누적 로지스틱)로 서열형 학습.

손실: ordinal(BCE 다중 임계) + focal(불균형 완화).

정합성 강화: 같은 영상의 강/약 증강 뷰에 대조학습 프리텍스트를 붙여 임베딩 안정화.

장점: ROI GT 불필요, 경계단계(CS2/CS3)에서 단계 거리를 직접 학습.

리스크: 패치가 엉뚱한 곳을 볼 수 있음 → Top-k MIL + DropInstance, 패치 위치를 하악 하연~경추 추정 띠(band)로 제한.

안 2) 소량(수십~100개 수준) 박스만: 능동학습(Active Learning) + 경량 검출기 → ROI 분리 + Ordinal 분류

핵심: 전수 라벨 대신 극히 일부 이미지에만 C2–C4 묶음 박스를 달고, 능동학습으로 모델이 헷갈리는 것만 점진 라벨링.

단계

초기 씨드: 50–100장 정도에 “C2–C4 포함 박스 1개”만 그린다(정밀 분할 불요).

경량 검출기(ResNet-FPN + Retina/FCOS 계열)를 학습 → 전 데이터에 pseudo-box 생성.

불확실성 상위 샘플만 띄워 재라벨→ 재학습(2–3 사이클).

최종 ROI crop으로 분류기(ResNet-18/34) 서열형 학습.

장점: 라벨링 비용을 박스 수십~100개 수준으로 제한하고, 이후는 자동화.

리스크: 초기가 흔들릴 수 있음 → **테스트-타임 Aug(TTA)**로 검출 안정화, 박스 주변 random jitter로 강건성 확보.

안 3) 반자동 분할(1–2 클릭/이미지): SAM류 도구로 윤곽 마스크 반자동 생성 → 형상지표 + 경량 분류

핵심: 완전 수동 분할 대신 한두 개 점/박스 클릭으로 C2–C4 마스크를 반자동 획득(예: SAM/준실시간 그래프컷).

파이프라인

클릭 유도: 미리 정의한 관심 띠 영역을 제시해 클릭 위치를 좁혀 작업 피로를 최소화.

마스크 후처리: largest component, 경계 스무딩.

형상 피처: 하연 concavity 깊이, 체부/하연 길이 비, 경사각, 곡률 통계 등 → XGBoost/경량 MLP.

장점: 라벨 품질 ↑, 해석가능성 확보. 완전 수동 대비 작업량 대폭 감소.

리스크: 여전히 클릭 필요 → 활성학습으로 “불확실/오류 의심 케이스만” 클릭.

선택 가이드

라벨링 리소스 거의 없음 → 안 1부터. 성능 상한 탐색 및 baseline 확보에 최적.

최소 박스 라벨은 가능 → 안 2. 실용성과 성능 균형이 가장 좋다.

설명가능성/임상 보고 중시 → 안 3. 논문 설득력(근거 시각화)이 강함.

공통 권장 설정

손실: 서열형(CORAL) + class-balanced focal 조합.

샘플링: class-balanced sampler와 mixup/cutmix 금지(형상 왜곡 위험).

평가: macro-F1, weighted κ, 단계거리 MAE(|예측−정답|), ±1-stage 수용률.

재현성: 환자 단위 분할, 5-fold CV, seed 고정.

시각화: 혼동행렬 + 예측-정답 거리 히스토그램 + 실패 케이스 리뷰.